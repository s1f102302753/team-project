<!DOCTYPE html>
<html>
<head>
    <title>å›è¦§æ¿ãƒ›ãƒ¼ãƒ </title>
</head>
<body>
    <h1>å›è¦§æ¿</h1>
    <ul>
        {% for notice in notices %}
            <li>{{ notice }}</li>
        {% empty %}
            <li>ãŠçŸ¥ã‚‰ã›ã¯ã‚ã‚Šã¾ã›ã‚“</li>
        {% endfor %}
    </ul>

    <hr>
    <h2>ğŸ“š PDFãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</h2>
    <input type="text" id="question" placeholder="è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
    <button id="ask-btn">é€ä¿¡</button>

    <div id="chat-result" style="margin-top:20px;"></div>

    <script>
        document.getElementById("ask-btn").addEventListener("click", async () => {
            const question = document.getElementById("question").value;
            if (!question) return alert("è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");

            const formData = new FormData();
            formData.append("question", question);

            const res = await fetch("{% url 'notices:chat_with_pdf' %}", {
                method: "POST",
                body: formData,
            });

            const data = await res.json();
            const resultDiv = document.getElementById("chat-result");

            if (res.ok) {
                resultDiv.innerHTML = `<p style="color:green;">å›ç­”: ${data.answer}</p>`;
            } else {
                resultDiv.innerHTML = `<p style="color:red;">ã‚¨ãƒ©ãƒ¼: ${data.error}</p>`;
            }
        });
    </script>
</body>
</html>

